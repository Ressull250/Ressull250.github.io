---
layout:     post
title:      JavaåŸºç¡€-æ¥å£
subtitle:   Ch6
date:       2018-10-13
author:     LiaoBo
header-img: img/header_02.jpg
catalog: true
tags:
    - Java
---
## 6.1 æ¥å£

##### 1.æ¥å£æ¦‚å¿µ

- æ¥å£ä¸æ˜¯ç±»ï¼Œè€Œæ˜¯å¯¹ç±»çš„ä¸€ç»„éœ€æ±‚æè¿°ï¼Œè¿™äº›ç±»è¦éµä»æ¥å£æè¿°çš„ç»Ÿä¸€æ ¼å¼è¿›è¡Œå®šä¹‰ï¼Œå¯ä»¥æ¥å£ç»§æ‰¿
- **æ¥å£ä¸­æ‰€æœ‰æ–¹æ³•è‡ªåŠ¨åœ°å±äºpublic**

##### 2.æ¥å£ç‰¹æ€§

- å£°æ˜æ¥å£çš„å˜é‡`Comparable x;`
- å¯ä»¥ç±»ä¼¼æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å±äºç‰¹å®šç±»ä¸€æ ·,ä¹Ÿå¯ä»¥ä½¿ç”¨`instance of`æ£€æŸ¥å¯¹è±¡æ˜¯å¦å®ç°äº†æŸä¸ªç‰¹å®šçš„æ¥å£

- æ¥å£ä¸­å¯ä»¥åŒ…å«å¸¸é‡ï¼Œæ¥å£ä¸­çš„åŸŸå°†è¢«è‡ªåŠ¨è®¾ä¸º`public static final`
  - å‡ºäºä¹ æƒ¯å¯ä»¥å°†æ¥å£æ–¹æ³•æ ‡è®°ä¸ºpublicï¼Œå°†åŸŸæ ‡è®°ä¸ºpublic static finalï¼Œä½†Javaè¯­è¨€è§„èŒƒå»ºè®®ä¸è¦ä¹¦å†™è¿™äº›å¤šä½™çš„å…³é”®å­—

##### 3.æ¥å£ä¸æŠ½è±¡ç±»

- Javaä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œæ¥å£å¯ä»¥æä¾›å¤šé‡ç»§æ‰¿çš„å¥½å¤„ï¼ŒåŒæ—¶é¿å…å¤šé‡ç»§æ‰¿çš„å¤æ‚æ€§å’Œä½æ•ˆæ€§

##### 4.é™æ€æ–¹æ³•ï¼ˆJava8ï¼‰

- é€šå¸¸çš„åšæ³•éƒ½æ˜¯å°†é™æ€æ–¹æ³•æ”¾åœ¨**ä¼´éšç±»**ä¸­ã€‚åœ¨æ ‡å‡†åº“ä¸­ï¼Œæœ‰æˆå¯¹å‡ºç°çš„æ¥å£å’Œå·¥å…·ç±»ï¼Œå¦‚Collection/Collectionsæˆ–Path/Paths
- åœ¨Java8ï¼Œ**å…è®¸åœ¨æ¥å£ä¸­åŠ å…¥é™æ€æ–¹æ³•**ï¼Œ**ä¸å†éœ€è¦ä¸ºæ¥å£é¢å¤–æä¾›ä¸€ä¸ªä¼´éšç±»**

##### 5.é»˜è®¤æ–¹æ³•ï¼ˆJava8ï¼‰

- å¯ä»¥ä¸ºæ¥å£æ–¹æ³•æä¾›ä¸€ä¸ªé»˜è®¤å®ç°ã€‚å¿…é¡»ç”¨`default`å…³é”®å­—æ ‡è®°è¿™æ ·ä¸€ä¸ªæ–¹æ³•

- ``` java
  interface Formula {
      double calculate(int a);
  
      default double sqrt(int a) {
          return Math.sqrt(a);
      }
  }
  ```

##### 6.è§£å†³é»˜è®¤æ–¹æ³•å†²çª

- åŸåˆ™ï¼š
  - 1.**è¶…ç±»ä¼˜å…ˆ**ã€‚å¦‚æœè¶…ç±»æä¾›äº†ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼ŒåŒåä¸”æœ‰ç›¸åŒç±»å‹å‚æ•°çš„é»˜è®¤æ–¹æ³•å°†è¢«å¿½ç•¥
  - 2.æ¥å£å†²çªã€‚å¦‚æœä¸€ä¸ªè¶…æ¥å£æä¾›äº†é»˜è®¤æ–¹æ³•ï¼Œå¦ä¸€ä¸ªæ¥å£æä¾›äº†ä¸€ä¸ªåŒåä¸”å‚æ•°ç±»å‹ç›¸åŒçš„æ–¹æ³•ï¼Œ**å¿…é¡»è¦†ç›–è¿™ä¸ªæ–¹æ³•æ¥è§£å†³å†²çª**ã€‚
- Note:
  - å¦‚æœä¸¤ä¸ªæ¥å£éƒ½æ²¡æœ‰ä¸ºå…±äº«æ–¹æ³•æä¾›é»˜è®¤å®ç°ï¼Œåˆ™ä¸å­˜åœ¨å†²çª
    - å®ç°ç±»è¦ä¹ˆé€‰æ‹©å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œè¦ä¹ˆä¸å®ç°ï¼ˆè¿™æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼‰
  - ç±»ä¼˜å…ˆåŸåˆ™å¯ä»¥ç¡®ä¿ä¸java7çš„å…¼å®¹æ€§ã€‚å¦‚æœä¸ºä¸€ä¸ªæ¥å£å¢åŠ é»˜è®¤æ–¹æ³•ï¼Œè¿™å¯¹äºæœ‰è¿™ä¸ªé»˜è®¤æ–¹æ³•ä¹‹å‰èƒ½æ­£å¸¸å·¥ä½œçš„ä»£ç ä¸ä¼šæœ‰ä»»ä½•å½±å“ã€‚



## 6.2 æ¥å£ç¤ºä¾‹

- Comparatoræ¥å£
- Cloneableæ¥å£
  - cloneæ–¹æ³•æ˜¯Objectçš„ä¸€ä¸ªprotectedæ–¹æ³•ï¼Œéè¯¥ç±»æ— æ³•ç›´æ¥è°ƒç”¨
  - é»˜è®¤çš„cloneæ˜¯â€œæµ…æ‹·è´â€ï¼Œå¹¶æ²¡æœ‰å…‹éš†å¯¹è±¡ä¸­å¼•ç”¨çš„å…¶ä»–å¯¹è±¡
    - å¦‚æœå…±äº«å­å¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼Œå¦‚Stringç±»å°±æ˜¯å®‰å…¨çš„
    - æˆ–è€…å­å¯¹è±¡åŒ…å«ä¸å˜çš„å¸¸é‡ï¼Œä¹Ÿæ˜¯å®‰å…¨çš„
  - cloneæ–¹æ³•æ²¡æœ‰è°ƒç”¨åˆ°æ„é€ æ–¹æ³•
- å®ç°å…‹éš†
  - **å¿…é¡»å®ç°Cloneableæ¥å£**
  - **é‡æ–°å®šä¹‰cloneæ–¹æ³•ï¼Œå¹¶æŒ‡å®špublicè®¿é—®ä¿®é¥°ç¬¦**
- Note:
  - **æ ‡è®°æ¥å£**ï¼Œä¸åŒ…å«ä»»ä½•æ–¹æ³•ï¼›å”¯ä¸€ä½œç”¨å°±æ˜¯å…è®¸åœ¨ç±»å‹æŸ¥è¯¢ä¸­ä½¿ç”¨instanceof
  - å¦‚Cloneableï¼ŒRandomAccessï¼ŒSerializable
- å…¶ä»–å…‹éš†å¯¹è±¡çš„æ–¹å¼ï¼š
  - åºåˆ—åååºåˆ—åŒ–
  - è½¬æˆjsonåå†è§£æ



## 6.3 Lambdaè¡¨è¾¾å¼

ä»¥å‰å†™äº†ä¸ª[Java8æ–°ç‰¹æ€§](http://zyb250.top/2018/04/10/Java8%E6%96%B0%E7%89%B9%E6%80%A7/)ï¼Œæœ‰ä¸€äº›å…³äºlambdaè¡¨è¾¾å¼çš„å†…å®¹

##### 1.lambdaè¡¨è¾¾å¼çš„è¯­æ³•

`(first,second) -> first.length() - second.length()`

##### 2.å‡½æ•°å¼æ¥å£

- å¯¹äºåªæœ‰ä¸€ä¸ªæŠ½è±¡çš„æ¥å£ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªlambdaè¡¨ç¤ºå¼ã€‚ç§°ä¸ºå‡½æ•°å¼æ¥å£
- å¯ä»¥é€šè¿‡åŠ **@FunctionalInterface**æ³¨è§£æ ‡è¯†è¿™ä¸ªå‡½æ•°æ¥å£(æ³¨è§£æ˜¯å¯é€‰çš„)
- å¸¸è§çš„å‡½æ•°å¼æ¥å£å¯ä»¥çœ‹ğŸ‘†çš„é“¾æ¥

##### 3.æ–¹æ³•å¼•ç”¨

- `Timer t = new Timer(1000, event -> System.out.println(event));`å¯ä»¥æ”¹å†™ä¸º<br>`Timer t = new Timer(1000, System.out::println);`<br>
- ä¸‰ç§æƒ…å†µï¼š
  - object::instanceMethod<br>Class::staticMethod<br>Class::instanceMethod
  - å¯¹äºå‰ä¸¤ç§æ–¹æ³•å¼•ç”¨ç­‰ä»·äº**æä¾›æ–¹æ³•å‚æ•°çš„lambdaè¡¨è¾¾å¼**<br>å¦‚`System.out::println`ç­‰ä»·äº `x -> System.out.println(x)`<br>`Math::pow`ç­‰ä»·äº`(x,y) -> Math.pow(x, y)`
  - å¯¹äºç¬¬ä¸‰ç§æƒ…å†µï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¼šæˆä¸ºæ–¹æ³•çš„ç›®æ ‡<br>`String::compareToIgnoreCase`ç­‰åŒäº`(x,y) -> x.compareToIgnoreCase(y)`
- å¯ä»¥åœ¨æ–¹æ³•å‚æ•°ä¸­ä½¿ç”¨thiså‚æ•°
  - `this::equals`ç­‰åŒäº`x -> this.equals(x)`
  - ä½¿ç”¨superä¹Ÿæ˜¯åˆæ³•çš„ï¼ŒsuperæŒ‡å‘ç»§æ‰¿é“¾æœ€é è¿‘çš„ä¸€ä¸ªè¶…ç±»

##### 4.æ„é€ å™¨å¼•ç”¨

- é€šè¿‡`Person::new`å¼•ç”¨æ„é€ å™¨

- ```java
  ArrayList<String> names = ...;
  Stream<Person> stream = names.stream().map(Person::new);
  //è¿™é‡Œmapæ–¹æ³•ä¼šå»è°ƒç”¨Person(String)çš„æ„é€ æ–¹æ³•ï¼Œä»ä¸Šä¸‹æ–‡æ¨å¯¼å¾—å‡ºçš„
  ```

##### 5.å˜é‡ä½œç”¨åŸŸ

- lambdaè¡¨è¾¾å¼å¯ä»¥æ•è·å¤–å›´ä½œç”¨åŸŸä¸­å˜é‡çš„å€¼
- è¢«æ•è·çš„å˜é‡å¿…é¡»å®é™…ä¸Šæ˜¯**æœ€ç»ˆå˜é‡**ï¼Œæœ€ç»ˆå˜é‡æ˜¯æŒ‡ï¼Œè¿™ä¸ªå˜é‡åˆå§‹åŒ–åå°±ä¸ä¼šå†ä¸ºå®ƒèµ‹æ–°å€¼
- åœ¨lambdaè¡¨è¾¾å¼ä¸­ä½¿ç”¨thiså…³é”®å­—ï¼Œæ˜¯æŒ‡åˆ›å»ºè¿™ä¸ªlambdaè¡¨è¾¾å¼çš„æ–¹æ³•çš„thiså‚æ•°

##### 6.å†è°ˆComparator

- Java8æ¥å£å¯ä»¥åŒ…å«é™æ€æ–¹æ³•
- å¯ä»¥é€šè¿‡`Comparator.comparing(Employee::getSalary);`æ„é€ ä¸€ä¸ªcomparator<br>`      Comparator.comparing(Employee::getSalary).thenComparing(Employee::getBonus);`å¦‚æœsalaryç›¸åŒå°±ä¼šæ¯”è¾ƒbonus
- åˆ©ç”¨`Camparator.comparingInt\Double\long`å¯ä»¥**é¿å…åŸºæœ¬ç±»å‹çš„è‡ªåŠ¨è£…ç®±**
- nullsFirst, nullsLastæ–¹æ³•å°†è¿”å›ä¸€ä¸ªæ¥å—nullé”®å€¼çš„æ¯”è¾ƒå™¨ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªæ¯”è¾ƒå™¨



## 6.4 å†…éƒ¨ç±»

- ä½¿ç”¨å†…éƒ¨ç±»çš„åŸå› ï¼š
  - å†…éƒ¨ç±»æ–¹æ³•å¯ä»¥è®¿é—®è¯¥ç±»å®šä¹‰çš„æ‰€æœ‰åŸŸï¼ŒåŒ…æ‹¬ç§æœ‰åŸŸ
  - å†…éƒ¨ç±»å¯ä»¥å¯¹åŒä¸€ä¸ªåŒ…ä¸­çš„å…¶ä»–ç±»éšè—èµ·æ¥
  - å®šä¹‰å›è°ƒå‡½æ•°æ—¶æ›´æ–¹ä¾¿ï¼ˆåŒ¿åå†…éƒ¨ç±»ï¼Œlambda is betterï¼‰

##### 1.ä½¿ç”¨å†…éƒ¨ç±»è®¿é—®å¯¹è±¡çŠ¶æ€

- å†…éƒ¨ç±»æ—¢å¯ä»¥è®¿é—®è‡ªèº«çš„æ•°æ®åŸŸï¼Œä¹Ÿå¯ä»¥è®¿é—®åˆ›å»ºå®ƒçš„å¤–å›´ç±»å¯¹è±¡çš„æ•°æ®åŸŸ
- å†…éƒ¨ç±»æœ‰ä¸€ä¸ªéšå¼å¼•ç”¨ï¼ŒæŒ‡å‘äº†åˆ›å»ºå®ƒçš„å¤–éƒ¨ç±»å¯¹è±¡

##### 2. å†…éƒ¨ç±»çš„ç‰¹æ®Šè¯­æ³•è§„åˆ™

```java
//å†…éƒ¨ç±»å¼•ç”¨å¤–éƒ¨ç±»çš„éçœç•¥å½¢å¼
OuterClass.this

//ä¾‹å¦‚
TalkingClock.this.beep

//åœ¨å¤–éƒ¨ç±»çš„ä½œç”¨åŸŸä¹‹å¤–å¼•ç”¨å†…éƒ¨ç±»
OuterClass.InnerClass

Employee e = new Employee("awards");
Employee.Node node = e.new Employee.Node();
```

- å†…éƒ¨ç±»å£°æ˜çš„é™æ€åŸŸå¿…é¡»æ˜¯final
- å†…éƒ¨ç±»ä¸èƒ½æœ‰é™æ€æ–¹æ³•

##### 3.å†…éƒ¨ç±»æ˜¯ä¸€ç§ç¼–è¯‘å™¨ç°è±¡

- å†…éƒ¨ç±»ä¸è™šæ‹Ÿæœºæ— å…³ï¼Œå†…éƒ¨ç±»ç”±ç¼–è¯‘å™¨å®ç° 
  å†…éƒ¨ç±»è¢«ç”¨åˆ†å‰²æˆç±»ä¼¼TalkingClockåˆ†å‰²æˆç±»ä¼¼TalkingClock$TimePrinter.classçš„å¸¸è§„ç±»æ–‡ä»¶ï¼Œå¯¹æ­¤è™šæ‹Ÿæœºä¸€æ— æ‰€çŸ¥

##### 4.å±€éƒ¨å†…éƒ¨ç±»

- å±€éƒ¨ç±»ä¸èƒ½ç”¨publicæˆ–privateä¿®é¥°ç¬¦è¿›è¡Œå£°æ˜ï¼Œå®ƒçš„ä½œç”¨åŸŸé™å®šåœ¨å£°æ˜è¿™ä¸ªå±€éƒ¨ç±»çš„å—ä¸­
- å±€éƒ¨ç±»ä¸ä»…èƒ½å¤Ÿè®¿é—®åŒ…å«ä»–ä»¬çš„å¤–éƒ¨ç±»ï¼Œè¿˜èƒ½è®¿é—®å£°æ˜ä¸ºfinalçš„å±€éƒ¨å˜é‡

##### 5.åŒ¿åå†…éƒ¨ç±»

```java
public void start(int interval,final boolean beep){
    ActionListener listener=new ActionListener(){
        public void actionPerformed(ActionEvent event){
            Date now=new Date();
            System.out.println("At the tone,the time is"+now);
            if(beep)Toolkit.getDefaultToolkit().beep();
        }
    };
    Timer t=new Timer(interval,listener);
    t.start();
}
```

- é€šå¸¸çš„æ ¼å¼

- ```java
  new SuperType(Construction params){
      //inner class methods and data
  }
  æˆ–
  new InterfaceType(){
      //methods and datas
  }
  //SuperTypeå¯ä»¥æ˜¯æ¥å£ï¼Œå†…éƒ¨ç±»è¦å®ç°è¿™ä¸ªæ¥å£
  //SuperTypeä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç±»ï¼Œå†…éƒ¨ç±»è¦æ‰©å±•å®ƒ
  ```

- ç”¨lambdaè¡¨è¾¾å¼ä»£æ›¿åŒ¿åå†…éƒ¨ç±»is better

- **Notes:**
  - åŒæ‹¬å·åˆå§‹åŒ–ï¼š
    - `new ArrayList<String>{{add("harry"); add("Tony")}};`
    - å¤–å±‚æ‹¬å·å»ºç«‹äº†ArrayListçš„ä¸€ä¸ªåŒ¿åå­ç±»ã€‚å†…å±‚æ‹¬å·åˆ™æ˜¯ä¸€ä¸ªå¯¹è±¡æ„é€ å—
  - å¯¹åŒ¿åå­ç±»åšgetClassçš„ç›¸ç­‰æµ‹è¯•ä¼šå¤±è´¥

##### 6.é™æ€å†…éƒ¨ç±»ï¼ˆnested classï¼‰

- å†…éƒ¨ç±»ä¸éœ€è¦å¼•ç”¨å¤–éƒ¨ç±»ï¼Œåªæ˜¯æƒ³æŠŠç±»éšè—åœ¨åˆ«çš„ç±»ä¸­ï¼Œå¯ä»¥ä½¿ç”¨static 

- åœ¨å†…éƒ¨ç±»ä¸éœ€è¦è®¿é—®å¤–å›´ç±»æ—¶ï¼Œåº”è¯¥ä½¿ç”¨é™æ€å†…éƒ¨ç±»

- å†…éƒ¨ç±»å¯¹è±¡åœ¨é™æ€æ–¹æ³•ä¸­æ„é€ ï¼Œå¿…é¡»ä½¿ç”¨é™æ€å†…éƒ¨ç±»

- ```java
  public static Pair minmax(double[] d){
      ...
      return new Pair(min, max);
  }
  ```

- ä¸å¸¸è§„å†…éƒ¨ç±»ä¸åŒï¼Œé™æ€å†…éƒ¨ç±»å¯ä»¥æœ‰é™æ€åŸŸå’Œæ–¹æ³•

- å£°æ˜åœ¨æ¥å£ä¸­çš„å†…éƒ¨ç±»è‡ªåŠ¨æˆä¸ºstaticå’Œpublicç±»



## 6.5 ä»£ç† todo

- æœ‰ç‚¹ç»•ï¼Œå…ˆçœ‹å®ŒJVMå†å›æ¥è¡¥
- èµ„æ–™ï¼š
  - https://www.cnblogs.com/xiaoluo501395377/p/3383130.html